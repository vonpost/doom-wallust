# doom-wallust

Wallust-driven color palettes for Doom Emacs.  This repository provides
`doom-wallust.el`, an opinionated Doom theme that rebuilds itself from the
Elisp snippet generated by [Wallust](https://codeberg.org/explosion-mental/wallust)
via the bundled template.  Trigger it manually after Wallust runs (just
`load-file` the generated `.el`) or keep it in sync with a file watcher.

## Features

- Loads the palette emitted by Wallust's template system (defaults to
  `~/.cache/wallust/doom-wallust-colors.el`).
- Builds a cohesive Doom-styled theme on the fly and exposes it as the normal
  `doom-theme` named `doom-wallust`.
- Optional file watcher (using `file-notify`) to refresh the theme whenever
  Wallust regenerates colors.

## Usage

1. Drop `doom-wallust.el` somewhere on your `load-path` (for Doom Emacs, a
   common option is `~/.config/doom/lisp/`).
2. Require it from `config.el` and add a helper command:

   ```emacs-lisp
   (use-package doom-wallust
     :load-path "~/path/to/doom-wallust/"
     :commands (doom-wallust-apply doom-wallust-start-watching)
     :config
     ;; Apply colors immediately
     (doom-wallust-apply)
     ;; Optional: watch the palette file for changes
     ;; (doom-wallust-start-watching)
     (setq doom-theme 'doom-wallust))
   ```

3. Run `M-x doom-wallust-apply` whenever Wallust updates its palette or enable
   the watcher via `M-x doom-wallust-start-watching`.

If your template writes somewhere else, update `doom-wallust-palette-file`
before calling `doom-wallust-apply`:

```emacs-lisp
(setq doom-wallust-palette-file "~/my/palette.el")
```

### Theme tweaks

You can fine-tune the Doom-facing look with these variables:

- `doom-wallust-brighter-modeline` – use brighter colors for the mode-line.
- `doom-wallust-brighter-comments` – tint comments with accent hues.
- `doom-wallust-comment-bg` – add a subtle background behind comments.
- `doom-wallust-padded-modeline` – add extra padding to the mode-line (integer or non-nil for default 4px).

Set them before calling `doom-wallust-apply` and they will take effect immediately.

## Wallust template

This repo ships `templates/doom-wallust-colors.el`, a Wallust template written in the
v3 Jinja subset that emits a ready-to-load Emacs Lisp file.  Point Wallust at
the template from your `wallust.toml`:

```toml
[templates]
"~/.cache/wallust/doom-wallust-colors.el" = "/path/to/doom-wallust/templates/doom-wallust-colors.el"
```

Once Wallust regenerates the template you can simply evaluate the file:

```emacs-lisp
(load-file "~/.cache/wallust/doom-wallust-colors.el") ; applies doom-wallust immediately
```

`doom-wallust-apply` (or `doom-wallust-start-watching`) uses the same file path,
so your usual workflow keeps working while benefiting from Wallust's template
engine. The template also pre-computes the shaded bases (base0–base8), alternate
backgrounds, selection, comment, and other theme-specific slots, so Emacs no
longer performs any runtime color math. Because of this, every key that
`doom-wallust.el` consumes must be present in the generated file; if you tweak
the template, keep those bindings intact.

## Notes

- The theme requires Emacs 27.1+ (for modern theme APIs and file-notify
  improvements).
- Watching the palette file depends on `file-notify-support-p`.  On systems
  where the notification backend is missing, you can still call
  `doom-wallust-apply` manually.
